function onLoad(e){e||get_data("reenter_password",function(){onLoad(!0)})}document.getElementById("createanaccount")&&set_innertext(document.getElementById("createanaccount"),gs("Create Account")),document.getElementById("cancel")&&set_innertext(document.getElementById("cancel"),gs("Cancel"));var newdata,dobeforeunload=!0,docleardata=!0;function do_submit(){dobeforeunload=!1,document.getElementById("reenterpassword").value!=getBG().g_create_account_data.masterpassword?(alert(gs("The LastPass master password you reentered does not match")),docleardata=!1,redirect_to_url("create_account.html")):(document.getElementById("createanaccount").disabled=!0,document.getElementById("cancel").disabled=!0,document.getElementById("creatingaccount").style.display="block",setInterval(function(){move_password_meter()},10),createAccount())}var currstrength=0;function move_password_meter(){++currstrength>100&&(currstrength=0),update_password_meter_manual(currstrength,document)}var createextra="";function createAccount(e){if(getBG().LPISLOC){if(!e){set_innertext(document.getElementById("creatingaccounttext"),gs("Reencrypting Data..."));var t=fix_username(getBG().g_create_account_data.email),a=getBG().g_create_account_data.masterpassword;return void getBG().change_master_password(t,a,!0,function(e){newdata=e,createAccount(!0)})}if("string"!=typeof newdata||newdata.length<4||"LPAV"!=newdata.substring(0,4))return void showCreateErrorAndBackup(gs("An error occurred while re-encrypting your data"))}set_innertext(document.getElementById("creatingaccounttext"),gs("Creating Account..."));var r=getBG().g_create_account_data.email.toLowerCase().replace(/\s*/g,""),n=getBG().g_create_account_data.masterpassword;getBG().make_lp_key_hash_iterations(r,n,get_key_iterations(r),function(e,t){var a=getBG().g_create_account_data.improve,n=getBG().g_create_account_data.history,o=getBG().g_create_account_data.timezone,c=getBG().g_create_account_data.passwordreminder,s="username="+getBG().en(r)+"&email="+getBG().en(r)+"&hash="+getBG().en(t)+"&password_hint="+getBG().en(c)+(a?"&improve=1":"")+(n?"&loglogins=1":"")+"&timezone2="+getBG().en(o)+"&iterations="+getBG().en(get_key_iterations(r))+"&xml=1&language2=en-US"+createextra;getBG().LPISLOC&&getBG().LPISUPEK&&(s+="&singlefactortype=vtapi"),getBG().create_account(s,lpCreateAccountResponse,lpcreateaccounterror)})}function upload_data(){set_innertext(document.getElementById("creatingaccounttext"),gs("Uploading Data..."));var e=fix_username(getBG().g_create_account_data.email),t=getBG().g_create_account_data.masterpassword;getBG().make_lp_key_hash_iterations(e,t,get_key_iterations(e),function(t,a){var r="wxusername="+encodeURIComponent(e)+"&wxhash="+encodeURIComponent(a)+"&data="+encodeURIComponent(btoa(newdata));getBG().lpMakeRequest(getBG().base_url+"import_local.php",r,lpUploadDataResponse,lpuploaddataerror)})}function lpCreateAccountResponse(e){if(4==e.readyState&&200==e.status&&e.responseText){var t=e.responseText,a="";if(t.indexOf("ok")>=0)return void(getBG().LPISLOC?upload_data():(getBG().LP_do_login(getBG().g_create_account_data.email,getBG().g_create_account_data.masterpassword,!0,!1),redirect_to_url("homelocal2.html")));if(t.indexOf("usernametaken")>=0)a=gs("Email already in use, have you forgotten your password?");else if(t.indexOf("usernameinvalid")>=0||t.indexOf("emailfailed")>=0)a=gs("Invalid email address, try again");else{if(e&&e.responseXML&&e.responseXML.documentElement){var r=e.responseXML.getElementsByTagName("error");r&&r.length>0&&r[0].getAttribute("msg")&&(a=r[0].getAttribute("msg"))}""==a&&(a=gs("A server error occurred while processing your request."))}""!=a&&showCreateErrorAndBackup(a)}}function showCreateErrorAndBackup(e){alert(e),docleardata=!1,redirect_to_url("create_account.html")}function lpcreateaccounterror(e,t,a,r){showCreateErrorAndBackup(gs("A server error occurred while processing your request."))}function lpUploadDataResponse(e){4==e.readyState&&(200==e.status&&e.responseText&&e.responseText.indexOf("ok")>=0?(getBG().LPISUPEK&&getBG().lpvt_store_data_and_setsinglefactortype(encodeURIComponent(fix_username(getBG().g_create_account_data.email))+"|"+encodeURIComponent(getBG().g_create_account_data.masterpassword)),getBG().delete_file("LPISLOC"),redirect_to_url("congratulations.html")):lpuploaddataerror())}function lpuploaddataerror(e,t,a,r){confirm(gs("An error occurred while uploading your data.  Would you like to retry?"))&&upload_data()}document.getElementById("reenterpassword").focus();
//# sourceMappingURL=sourcemaps/reenter_password15.js.map
